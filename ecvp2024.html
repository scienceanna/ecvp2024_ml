<!DOCTYPE html>
<html lang="en"><head>
<script src="ecvp2024_files/libs/clipboard/clipboard.min.js"></script>
<script src="ecvp2024_files/libs/quarto-html/tabby.min.js"></script>
<script src="ecvp2024_files/libs/quarto-html/popper.min.js"></script>
<script src="ecvp2024_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="ecvp2024_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ecvp2024_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="ecvp2024_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="ecvp2024_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.433">

  <meta name="author" content="A.D.F Clarke &amp; A.E. Hughes">
  <title>Multi-level modelling and data visualisation in R</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="ecvp2024_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="ecvp2024_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="ecvp2024_files/libs/revealjs/dist/theme/quarto.css">
  <link href="ecvp2024_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="ecvp2024_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="ecvp2024_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="ecvp2024_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="ecvp2024_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="ecvp2024_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Multi-level modelling and data visualisation in R</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
A.D.F Clarke &amp; A.E. Hughes 
</div>
</div>
</div>

</section>
<section class="slide level2">

<div class="cell" data-layout-align="center">
<style type="text/css">
.small-code div.cell-output-stdout {
  font-size: 0.8em;
}

.tiny-code div.cell-output-stdout {
  font-size: 0.70em;
}
</style>
</div>
</section>
<section id="course-overview" class="slide level2">
<h2>Course Overview</h2>
<ul>
<li class="fragment">Example 1: why multi-level models, random intercepts, prediction, plotting</li>
<li class="fragment">Example 2: more complex multi-level models, model fit problems, inference, publication plotting</li>
<li class="fragment">Example 3: calculating psychophysical thresholds using multi-level models</li>
</ul>
<div class="fragment">
<p>Course materials available <a href="https://github.com/scienceanna/ecvp2024_ml">on Github</a>.</p>
</div>
</section>
<section id="whats-our-approach" class="slide level2">
<h2>What’s our approach?</h2>
<ul>
<li class="fragment">It is really easy to end up working with statistical techniques we find a bit mystifying</li>
<li class="fragment">We want to take a step back and give you a bit more of an intuition about what we are actually doing when we fit mixed effects models</li>
<li class="fragment">Focus on trying to understand the broad points</li>
</ul>
</section>
<section id="introductions" class="slide level2">
<h2>Introductions</h2>
<p><img data-src="images/alasdair.jpg" style="width:30.0%"> <small> <em>Alasdair studied mathematics at the University of Warwick, before obtaining a PhD in Computer Science from Heriot-Watt University. Since then, he has worked at School of Informatics at the University of Edinburgh, and the School of Psychology at the University of Aberdeen, before joining the psychology department at the University of Essex in 2016. His research interests include eye movements during visual search and decision making. Recently, he has been writing a statistics textbook which he will plug now.</em> </small></p>
</section>
<section id="introductions-1" class="slide level2">
<h2>Introductions</h2>
<p><img data-src="images/anna.jpg" style="width:30.0%"> <small> <em>Anna did her PhD at the University of Cambridge, has since worked at University College London and the University of Exeter, and joined the University of Essex as a lecturer in 2020. Her research focuses on a variety of questions about how humans and other animals might use visual information to search and interact with the world - including how best to optimise camouflage in multiple environments, and exactly why zebras might have stripes. She really likes R, the tidyverse, and very large cups of tea.</em> </small></p>
</section>
<section>
<section id="example-1-tips-from-the-top" class="title-slide slide level1 center">
<h1>Example 1: Tips from the Top</h1>

</section>
<section id="levari-2022-tips-from-the-top" class="slide level2">
<h2>Levari (2022): Tips from the Top</h2>
<ul>
<li class="fragment"><p>Are people who are good at a task able to give more useful advice to help others complete the same task?</p></li>
<li class="fragment"><p>In part of their study, 78 participants completed a Word search game six times.</p></li>
<li class="fragment"><p>Do participants get better with practice?</p></li>
</ul>
<div class="fragment">
<p><em>Levari, D. E., Gilbert, D. T., &amp; Wilson, T. D. (2022). Tips from the top: Do the best performers really give the best advice? Psychological Science, 33(5), 685-698.</em></p>
</div>
</section>
<section id="data-import" class="slide level2">
<h2>Data Import</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/study2_advisor_improvement.csv"</span>,</span>
<span id="cb1-2"><a href="#cb1-2"></a>              <span class="at">col_types =</span> <span class="st">"fii"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is good practice to use <code>col_types</code> to make sure <code>read_csv()</code> reads in the data in the correct format.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 468 × 3
   participant score roundnum
   &lt;fct&gt;       &lt;int&gt;    &lt;int&gt;
 1 ad01            9        1
 2 ad01            6        2
 3 ad01            9        3
 4 ad01           10        4
 5 ad01           13        5
 6 ad01           11        6
 7 ad21           15        1
 8 ad21           25        2
 9 ad21           20        3
10 ad21           24        4
# ℹ 458 more rows</code></pre>
</div>
</div>
</section>
<section id="a-simple-plot" class="slide level2">
<h2>A simple plot</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(roundnum, score)) <span class="sc">+</span> </span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="improving-the-plot" class="slide level2">
<h2>Improving the plot</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(roundnum, score)) <span class="sc">+</span> </span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>, <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="maybe-box-plots-are-better" class="slide level2">
<h2>Maybe box plots are better?</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(roundnum, score)) <span class="sc">+</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch quarto-figure-center"><ul>
<li class="fragment">The <span class="math inline">\(x\)</span>-axis is numeric, rather than categorical, so <code>geom_boxplot()</code> doesn’t quite do what we expect!</li>
</ul>
</section>
<section id="maybe-box-plots-are-better-1" class="slide level2">
<h2>Maybe box plots are better?</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="fu">factor</span>(roundnum), score)) <span class="sc">+</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-7-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="improve-axis-title" class="slide level2">
<h2>Improve axis title</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="fu">factor</span>(roundnum), score)) <span class="sc">+</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="st">"round number"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch quarto-figure-center"><ul>
<li class="fragment">Are people getting better over time?</li>
</ul>
</section>
<section id="no-pooling---linear-regression" class="slide level2">
<h2>No Pooling - Linear Regression</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> roundnum, d)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = score ~ roundnum, data = d)

Residuals:
    Min      1Q  Median      3Q     Max 
-10.073  -4.121  -0.732   2.927  18.610 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    8.804      0.559   15.76   &lt;2e-16 ***
roundnum       0.317      0.143    2.21    0.027 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.3 on 466 degrees of freedom
Multiple R-squared:  0.0104,    Adjusted R-squared:  0.00826 
F-statistic: 4.89 on 1 and 466 DF,  p-value: 0.0275</code></pre>
</div>
</div>
</section>
<section id="total-pooling---aggregate" class="slide level2">
<h2>Total Pooling - Aggregate</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>d <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(roundnum) <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">summarise</span>(<span class="at">score =</span> <span class="fu">mean</span>(score)) <span class="ot">-&gt;</span> dp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="total-pooling---aggregate-1" class="slide level2">
<h2>Total Pooling - Aggregate</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> roundnum, <span class="at">data =</span> dp)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = score ~ roundnum, data = dp)

Residuals:
     1      2      3      4      5      6 
-0.160  0.125 -0.128  0.286  0.110 -0.233 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   8.8043     0.2111   41.70    2e-06 ***
roundnum      0.3172     0.0542    5.85   0.0043 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.227 on 4 degrees of freedom
Multiple R-squared:  0.895, Adjusted R-squared:  0.869 
F-statistic: 34.2 on 1 and 4 DF,  p-value: 0.00426</code></pre>
</div>
</div>
</section>
<section id="comparison" class="slide level2">
<h2>Comparison</h2>
<ul>
<li class="fragment">The two approaches give similar estimates for the intercept (8.8) and slope (0.32).</li>
<li class="fragment">However, the standard errors (and hence <span class="math inline">\(t\)</span> and <span class="math inline">\(p\)</span>-values) are quite different.</li>
<li class="fragment">The <span class="math inline">\(R^2\)</span> values are wildly different: 0.010 v 0.895!</li>
<li class="fragment">This is because we are throwing away a lot of the variance in the second model.</li>
</ul>
</section>
<section id="we-have-a-lot-of-variance" class="slide level2">
<h2>We have a lot of variance</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">ggplot</span>(dp, <span class="fu">aes</span>(roundnum, score)) <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">fill =</span> <span class="st">"purple"</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">colour =</span> <span class="st">"darkviolet"</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> d, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="what-are-individuals-doing" class="slide level2">
<h2>What are individuals doing?</h2>
<p>Linking up all the points leads to a cluttered plot</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(roundnum, score)) <span class="sc">+</span> </span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> participant), <span class="at">alpha =</span> <span class="fl">0.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="what-are-individuals-doing-1" class="slide level2">
<h2>What are individuals doing?</h2>
<p>We can make things easier to parse with highlights:</p>
<div class="fragment">
<div>
<ul>
<li>use the <code>sample()</code> function to randomly select 6 people.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>ids <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">levels</span>(d<span class="sc">$</span>participant), <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ad06" "ad58" "ad35" "ad26" "ad29" "ad71"</code></pre>
</div>
</div>
</div>
</div>
<div class="fragment">
<div>
<ul>
<li>then we can <code>filter()</code> to get their data</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>six_people <span class="ot">&lt;-</span> <span class="fu">filter</span>(d, participant <span class="sc">%in%</span> ids)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="what-are-individuals-doing-2" class="slide level2">
<h2>What are individuals doing?</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(roundnum, score)) <span class="sc">+</span> </span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> participant), <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> six_people, <span class="fu">aes</span>(<span class="at">colour =</span> participant), <span class="at">size =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="is-the-best-fit-line-any-good" class="slide level2">
<h2>Is the best-fit line any good?</h2>

<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-19-1.png" width="960" class="r-stretch quarto-figure-center"><p>It is clear that the residuals are clustered…</p>
<ul>
<li class="fragment">they are different for different people.</li>
</ul>
</section>
<section id="fitting-an-intercept-to-each-person" class="slide level2">
<h2>Fitting an intercept to each person</h2>
<div>
<ul>
<li>Add <code>participant</code> as a term in our model!</li>
</ul>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> participant <span class="sc">+</span> roundnum, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = score ~ 0 + participant + roundnum, data = d)

Residuals:
   Min     1Q Median     3Q    Max 
-9.492 -1.329 -0.159  1.492  8.960 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
participantad01   8.5564     1.0286    8.32  1.5e-15 ***
participantad21  19.2231     1.0286   18.69  &lt; 2e-16 ***
participantad02   2.7231     1.0286    2.65  0.00844 ** 
participantad22   9.0564     1.0286    8.80  &lt; 2e-16 ***
participantad23   4.0564     1.0286    3.94  9.5e-05 ***
participantad24   6.3897     1.0286    6.21  1.3e-09 ***
participantad03   8.0564     1.0286    7.83  4.6e-14 ***
participantad04   2.5564     1.0286    2.49  0.01336 *  
participantad25   7.2231     1.0286    7.02  9.8e-12 ***
participantad54   9.7231     1.0286    9.45  &lt; 2e-16 ***
participantad26  10.5564     1.0286   10.26  &lt; 2e-16 ***
participantad05  16.5564     1.0286   16.10  &lt; 2e-16 ***
participantad27   9.8897     1.0286    9.61  &lt; 2e-16 ***
participantad28   5.0564     1.0286    4.92  1.3e-06 ***
participantad76   5.8897     1.0286    5.73  2.1e-08 ***
participantad29   6.7231     1.0286    6.54  2.0e-10 ***
participantad06   3.8897     1.0286    3.78  0.00018 ***
participantad30  15.7231     1.0286   15.29  &lt; 2e-16 ***
participantad07   7.0564     1.0286    6.86  2.7e-11 ***
participantad31   3.0564     1.0286    2.97  0.00315 ** 
participantad55  11.8897     1.0286   11.56  &lt; 2e-16 ***
participantad75   5.7231     1.0286    5.56  4.9e-08 ***
participantad56  13.5564     1.0286   13.18  &lt; 2e-16 ***
participantad32  25.0564     1.0286   24.36  &lt; 2e-16 ***
participantad08   8.0564     1.0286    7.83  4.6e-14 ***
participantad33  10.0564     1.0286    9.78  &lt; 2e-16 ***
participantad34  10.2231     1.0286    9.94  &lt; 2e-16 ***
participantad57   6.8897     1.0286    6.70  7.4e-11 ***
participantad35   5.8897     1.0286    5.73  2.1e-08 ***
participantad77   8.3897     1.0286    8.16  4.8e-15 ***
participantad36  11.2231     1.0286   10.91  &lt; 2e-16 ***
participantad58   6.8897     1.0286    6.70  7.4e-11 ***
participantad09   4.7231     1.0286    4.59  5.9e-06 ***
participantad37   6.0564     1.0286    5.89  8.5e-09 ***
participantad38   7.7231     1.0286    7.51  4.1e-13 ***
participantad39   7.0564     1.0286    6.86  2.7e-11 ***
participantad40  11.0564     1.0286   10.75  &lt; 2e-16 ***
participantad41   7.5564     1.0286    7.35  1.2e-12 ***
participantad59   3.5564     1.0286    3.46  0.00061 ***
participantad60   4.5564     1.0286    4.43  1.2e-05 ***
participantad42   7.0564     1.0286    6.86  2.7e-11 ***
participantad10  13.0564     1.0286   12.69  &lt; 2e-16 ***
participantad43   8.7231     1.0286    8.48  4.7e-16 ***
participantad44   3.8897     1.0286    3.78  0.00018 ***
participantad61   5.8897     1.0286    5.73  2.1e-08 ***
participantad11  12.5564     1.0286   12.21  &lt; 2e-16 ***
participantad45   2.8897     1.0286    2.81  0.00521 ** 
participantad12   9.2231     1.0286    8.97  &lt; 2e-16 ***
participantad62  23.2231     1.0286   22.58  &lt; 2e-16 ***
participantad78  16.5564     1.0286   16.10  &lt; 2e-16 ***
participantad63  14.0564     1.0286   13.67  &lt; 2e-16 ***
participantad64   8.8897     1.0286    8.64  &lt; 2e-16 ***
participantad13   3.2231     1.0286    3.13  0.00186 ** 
participantad14   4.5564     1.0286    4.43  1.2e-05 ***
participantad15   3.0564     1.0286    2.97  0.00315 ** 
participantad46  15.7231     1.0286   15.29  &lt; 2e-16 ***
participantad47  13.5564     1.0286   13.18  &lt; 2e-16 ***
participantad65  10.5564     1.0286   10.26  &lt; 2e-16 ***
participantad16   9.8897     1.0286    9.61  &lt; 2e-16 ***
participantad17  11.7231     1.0286   11.40  &lt; 2e-16 ***
participantad66  15.2231     1.0286   14.80  &lt; 2e-16 ***
participantad74   4.7231     1.0286    4.59  5.9e-06 ***
participantad48   3.5564     1.0286    3.46  0.00061 ***
participantad49   2.7231     1.0286    2.65  0.00844 ** 
participantad50   9.3897     1.0286    9.13  &lt; 2e-16 ***
participantad67   8.5564     1.0286    8.32  1.5e-15 ***
participantad18   5.0564     1.0286    4.92  1.3e-06 ***
participantad68   5.2231     1.0286    5.08  5.9e-07 ***
participantad69  14.2231     1.0286   13.83  &lt; 2e-16 ***
participantad70   8.2231     1.0286    7.99  1.5e-14 ***
participantad51   5.0564     1.0286    4.92  1.3e-06 ***
participantad19  18.0564     1.0286   17.55  &lt; 2e-16 ***
participantad52  14.7231     1.0286   14.31  &lt; 2e-16 ***
participantad20   8.8897     1.0286    8.64  &lt; 2e-16 ***
participantad53   0.8897     1.0286    0.86  0.38758    
participantad71   9.8897     1.0286    9.61  &lt; 2e-16 ***
participantad72  11.0564     1.0286   10.75  &lt; 2e-16 ***
participantad73   4.8897     1.0286    4.75  2.8e-06 ***
roundnum          0.3172     0.0664    4.78  2.5e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.45 on 389 degrees of freedom
Multiple R-squared:  0.96,  Adjusted R-squared:  0.952 
F-statistic:  120 on 79 and 389 DF,  p-value: &lt;2e-16</code></pre>
</div>
</div>
</section>
<section id="this-fits-great" class="slide level2">
<h2>This fits great!</h2>

<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="disadvantages-of-this-approach" class="slide level2">
<h2>Disadvantages of this approach</h2>
<p>This model fits the data fantastically well: <span class="math inline">\(R^2=0.96\)</span>!</p>
<p>However, there are a few downsides:</p>
<ul>
<li class="fragment">It has 80 parameters! This seems overly complex.</li>
<li class="fragment">If a new participant comes along, we have no way to estimate their performance.</li>
</ul>
<div class="fragment">
<p>The solution is to model the variability in intercepts.</p>
</div>
</section>
<section id="multi-level-models" class="slide level2">
<h2>Multi-level Models</h2>
<div>
<ul>
<li>For participant <span class="math inline">\(k\)</span> we fit:</li>
</ul>
<p><span class="math display">\[y^k = (a + a_k) + bx + \epsilon\]</span></p>
</div>
<div>
<ul>
<li>We assume that the <span class="math inline">\(a^k\)</span> are normally distributed:</li>
</ul>
<p><span class="math display">\[a_k \sim \mathcal{N}(0, \theta_a)\]</span></p>
</div>
<ul>
<li class="fragment">This model has three main parameters: <span class="math inline">\(a, b\)</span> and <span class="math inline">\(\theta_a\)</span>.</li>
</ul>
</section>
<section id="multi-level-models-with-lme4" class="slide level2">
<h2>Multi-level Models with <code>lme4</code></h2>
<ul>
<li class="fragment"><code>lme4</code> is a popular package for R that allows us to fit these models.</li>
<li class="fragment">The main function is <code>lmer()</code>: <em>linear mixed effect regression</em>.</li>
<li class="fragment">The syntax is similar to the usual <code>lm()</code> syntax.</li>
</ul>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb21-2"><a href="#cb21-2"></a></span>
<span id="cb21-3"><a href="#cb21-3"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(score <span class="sc">~</span> roundnum <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>participant), <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="summary-for-lmer" class="slide level2">
<h2><code>summary()</code> for <code>lmer</code></h2>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: score ~ roundnum + (1 | participant)
   Data: d

REML criterion at convergence: 2415

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.878 -0.559 -0.072  0.600  3.649 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept) 22.26    4.72    
 Residual                 6.02    2.45    
Number of obs: 468, groups:  participant, 78

Fixed effects:
            Estimate Std. Error t value
(Intercept)   8.8043     0.5935   14.83
roundnum      0.3172     0.0664    4.78

Correlation of Fixed Effects:
         (Intr)
roundnum -0.392</code></pre>
</div>
</div>
<ul>
<li class="fragment">The output does not give <span class="math inline">\(p\)</span>-values or model fit criteria.</li>
</ul>
</section>
<section id="random-effects" class="slide level2">
<h2>Random Effects</h2>
<ul>
<li class="fragment">The main new part of the model summary is an overview of the <em>random effects</em>.</li>
<li class="fragment">In our case, these are the intercepts that vary from person to person.</li>
</ul>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">summary</span>(m4)<span class="sc">$</span>varcor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups      Name        Std.Dev.
 participant (Intercept) 4.72    
 Residual                2.45    </code></pre>
</div>
</div>
</div>
</section>
<section id="facet-plots" class="slide level2">
<h2>Facet Plots</h2>

<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-26-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="using-predict" class="slide level2">
<h2>Using <code>predict()</code></h2>
<p>If we call <code>predict()</code> with no <code>newdata</code> argument, it will make a prediction for every point in our training data</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>d<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="fu">predict</span>(m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li class="fragment">The <code>predict()</code> function for multi-level models is quite versatile and can take many different options</li>
<li class="fragment">For now, we can add these predictions to our plot as another layer:</li>
</ul>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a> <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fl">8.8</span>, <span class="at">slope =</span> <span class="fl">0.317</span>, <span class="at">colour =</span> <span class="st">"darkblue"</span>, <span class="at">linetype =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="our-model-predictions" class="slide level2">
<h2>Our Model Predictions</h2>

<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-29-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="distribution-of-intercepts" class="slide level2">
<h2>Distribution of Intercepts</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">ranef</span>(m4) <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(condval)) <span class="sc">+</span> </span>
<span id="cb27-4"><a href="#cb27-4"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">16</span>, </span>
<span id="cb27-5"><a href="#cb27-5"></a>                 <span class="at">colour =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-30-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<ul>
<li class="fragment"><p>The random intercept model allows us to model more of the variance in the data without having too many new parameters.</p></li>
<li class="fragment"><p>We could use this model to simulate a whole new set of participants.</p></li>
<li class="fragment"><p>Facet plots and highlights are useful to to visualise what is going on.</p></li>
<li class="fragment"><p>Remember to think about the random effect structure in your model - this is often overlooked when reporting models.</p></li>
</ul>
</section>
<section id="workbook" class="slide level2">
<h2>Workbook</h2>
<ul>
<li class="fragment"><p>We’ll now have a few minutes for you to do some coding yourselves</p></li>
<li class="fragment"><p>Either review the material so far (recommended if this is all fairly new to you)</p></li>
<li class="fragment"><p>Or there’s a data processing/plotting challenge</p></li>
<li class="fragment"><p>Please ask us questions!</p></li>
</ul>
</section></section>
<section>
<section id="example-2-in-out-asymmetry-in-crowding" class="title-slide slide level1 center">
<h1>Example 2: In-out asymmetry in crowding</h1>

</section>
<section id="in-out-asymmetry" class="slide level2">
<h2>In-out asymmetry</h2>
<p>Do peripheral flankers interfere more with a target than foveal flankers?</p>
<div class="fragment">
<p>Does this effect depend on location?</p>
</div>
<div class="fragment">
<p><em>Chakravarthi R, Rubruck J, Kipling N, Clarke ADF. Characterizing the in-out asymmetry in visual crowding. J Vis. 2021 Oct 5;21(11):10</em></p>
</div>
<div class="fragment">
<p>Data for this example available at <a href="https://osf.io/jdfmn">https://osf.io/jdfmn</a>.</p>
</div>
</section>
<section id="thresholds-and-data-import" class="slide level2">
<h2>Thresholds and data import</h2>
<p>Thresholds were calculated from QUEST in MATLAB.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>dat <span class="ot">&lt;-</span> R.matlab<span class="sc">::</span><span class="fu">readMat</span>(<span class="st">"data/allthresholds50.mat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tidying-your-data" class="slide level2">
<h2>Tidying your data</h2>
<p>We won’t dwell on this today, but you will almost certainly find your raw data needs some processing before analysis.</p>
<p>This can be a time consuming process! But nearly always worth the time investment.</p>
</section>
<section id="looking-at-the-data" class="slide level2">
<h2>Looking at the data</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">summary</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    observer    des     fla     loc          thr     
 Min.   : 1.0   b:456   n:456   r:342   Min.   :0.2  
 1st Qu.:10.0   p:456   i:456   u:342   1st Qu.:0.3  
 Median :19.5   r:456   o:456   l:342   Median :0.6  
 Mean   :19.5                   d:342   Mean   :1.1  
 3rd Qu.:29.0                           3rd Qu.:1.8  
 Max.   :38.0                           Max.   :4.7  
                                        NA's   :61   </code></pre>
</div>
</div>
<ul>
<li class="fragment"><strong>des</strong>: design (we’re not going to worry about this today)</li>
<li class="fragment"><strong>fla</strong>: flankers (<em>n</em>one, <em>i</em>nwards, <em>o</em>utwards)</li>
<li class="fragment"><strong>loc</strong>: location (<em>u</em>p, <em>d</em>own, <em>l</em>eft, <em>r</em>ight)</li>
</ul>
</section>
<section id="missing-data" class="slide level2">
<h2>Missing data</h2>
<p>We have some non-finite threshold values. We probably just want to remove them.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.finite</span>(thr)) <span class="ot">-&gt;</span> d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="some-basic-plotting" class="slide level2">
<h2>Some basic plotting</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(fla, thr)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-35-1.png" width="960" class="r-stretch quarto-figure-center"><ul>
<li class="fragment">Low thresholds when there’s no flanker</li>
<li class="fragment">Thresholds increase when adding a flanker, but more if the flanker is outwards</li>
</ul>
</section>
<section id="some-basic-plotting-1" class="slide level2">
<h2>Some basic plotting</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(loc, thr, <span class="at">fill =</span> fla)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-36-1.png" width="960" class="r-stretch quarto-figure-center"><ul>
<li class="fragment">Maybe some differences depending on location? Up and down have larger thresholds in the inside condition?</li>
</ul>
</section>
<section id="fitting-a-multi-level-model" class="slide level2">
<h2>Fitting a multi-level model</h2>
<p>We want to take into account the fact that we are running a repeated measures design, where each participant takes part in multiple trials.</p>
<ul>
<li class="fragment">How does threshold vary with location?</li>
<li class="fragment">How does the effect of threshold vary with flanker type?</li>
<li class="fragment">Take into account multiple data points for each observer using random intercepts</li>
</ul>
</section>
<section id="fitting-a-multi-level-model-1" class="slide level2">
<h2>Fitting a multi-level model</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lmer</span>(thr <span class="sc">~</span> loc <span class="sc">+</span> loc<span class="sc">:</span>fla <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>observer), <span class="at">data =</span> d)</span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: thr ~ loc + loc:fla + (1 | observer)
   Data: d

REML criterion at convergence: 2677

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.216 -0.490 -0.101  0.418  4.376 

Random effects:
 Groups   Name        Variance Std.Dev.
 observer (Intercept) 0.064    0.253   
 Residual             0.421    0.649   
Number of obs: 1307, groups:  observer, 38

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.24439    0.07331    3.33
locu         0.15528    0.08590    1.81
locl         0.00754    0.08590    0.09
locd         0.08546    0.08590    0.99
locr:flai    0.55950    0.08694    6.44
locu:flai    0.73384    0.08590    8.54
locl:flai    0.46329    0.08590    5.39
locd:flai    0.64239    0.08738    7.35
locr:flao    1.96123    0.08850   22.16
locu:flao    2.20829    0.08854   24.94
locl:flao    1.94759    0.09034   21.56
locd:flao    1.88141    0.08716   21.59

Correlation of Fixed Effects:
          (Intr) locu   locl   locd   locr:flai locu:flai locl:flai locd:flai
locu      -0.586                                                             
locl      -0.586  0.500                                                      
locd      -0.586  0.500  0.500                                               
locr:flai -0.579  0.494  0.494  0.494                                        
locu:flai  0.000 -0.500  0.000  0.000  0.000                                 
locl:flai  0.000  0.000 -0.500  0.000  0.000     0.000                       
locd:flai  0.000  0.000  0.000 -0.492  0.002     0.000     0.000             
locr:flao -0.569  0.485  0.485  0.485  0.479     0.000     0.000     0.000   
locu:flao  0.000 -0.485  0.000  0.000  0.000     0.485     0.000     0.000   
locl:flao  0.000  0.000 -0.475  0.000  0.000     0.000     0.475     0.000   
locd:flao  0.000  0.000  0.000 -0.493  0.000     0.000     0.000     0.484   
          locr:flao locu:flao locl:flao
locu                                   
locl                                   
locd                                   
locr:flai                              
locu:flai                              
locl:flai                              
locd:flai                              
locr:flao                              
locu:flao  0.001                       
locl:flao  0.001     0.001             
locd:flao  0.001     0.001     0.000   </code></pre>
</div>
</div>
</section>
<section id="fitting-a-multi-level-model-random-slopes" class="slide level2">
<h2>Fitting a multi-level model: random slopes</h2>
<p>We can do better than this: each person may not only have their own variable intercept, but their own variable <strong>slope</strong> i.e.&nbsp;how their thresholds are affected by the fixed factors of interest.</p>
</section>
<section id="fitting-a-multi-level-model-random-slopes-1" class="slide level2">
<h2>Fitting a multi-level model: random slopes</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(thr <span class="sc">~</span> loc <span class="sc">+</span> loc<span class="sc">:</span>fla <span class="sc">+</span> (loc <span class="sc">+</span> fla<span class="sc">|</span>observer), <span class="at">data =</span> d)</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="fu">summary</span>(m2)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: thr ~ loc + loc:fla + (loc + fla | observer)
   Data: d

REML criterion at convergence: 2238

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.800 -0.403 -0.037  0.228  5.244 

Random effects:
 Groups   Name        Variance Std.Dev. Corr                         
 observer (Intercept) 0.0213   0.146                                 
          locu        0.0444   0.211    -0.94                        
          locl        0.0646   0.254    -0.86  0.63                  
          locd        0.0463   0.215    -0.91  0.97  0.59            
          flai        0.2583   0.508    -0.44  0.48  0.35  0.34      
          flao        0.4646   0.682     0.37 -0.53 -0.10 -0.43  0.07
 Residual             0.2613   0.511                                 
Number of obs: 1307, groups:  observer, 38

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.24439    0.05341    4.58
locu         0.15528    0.07585    2.05
locl         0.00754    0.07927    0.10
locd         0.08546    0.07617    1.12
locr:flai    0.60411    0.10734    5.63
locu:flai    0.73384    0.10669    6.88
locl:flai    0.46329    0.10669    4.34
locd:flai    0.71428    0.10762    6.64
locr:flao    2.02152    0.13108   15.42
locu:flao    2.25341    0.13101   17.20
locl:flao    1.94672    0.13226   14.72
locd:flao    1.90387    0.13037   14.60

Correlation of Fixed Effects:
          (Intr) locu   locl   locd   locr:flai locu:flai locl:flai locd:flai
locu      -0.753                                                             
locl      -0.739  0.529                                                      
locd      -0.749  0.597  0.520                                               
locr:flai -0.550  0.447  0.410  0.400                                        
locu:flai -0.151 -0.117  0.142  0.120  0.594                                 
locl:flai -0.151  0.166 -0.129  0.120  0.594     0.597                       
locd:flai -0.150  0.165  0.140 -0.160  0.591     0.592     0.592             
locr:flao -0.190  0.030  0.178  0.064  0.208     0.046     0.046     0.046   
locu:flao  0.138 -0.431 -0.043 -0.166  0.046     0.210     0.046     0.045   
locl:flao  0.137 -0.199 -0.261 -0.164  0.045     0.046     0.208     0.045   
locd:flao  0.139 -0.202 -0.043 -0.397  0.046     0.046     0.046     0.209   
          locr:flao locu:flao locl:flao
locu                                   
locl                                   
locd                                   
locr:flai                              
locu:flai                              
locl:flai                              
locd:flai                              
locr:flao                              
locu:flao  0.714                       
locl:flao  0.707     0.706             
locd:flao  0.717     0.718     0.708   
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
</section>
<section id="fitting-a-multi-level-model-random-slopes-2" class="slide level2">
<h2>Fitting a multi-level model: random slopes</h2>
<p>Why could we not do this in Example 1?</p>
<div class="fragment">
<p>We only had one data point per participant per treatment level: this means between-participant variation in how they are affected by the within-participant predictor is confounded with random error (i.e.&nbsp;measurement error) and therefore we can only fit random intercepts.</p>
</div>
<div class="fragment">
<p>Where possible, design your experiments with multiple repeats per treatment level!</p>
</div>
</section>
<section id="fitting-a-multi-level-model-improving-the-model" class="slide level2">
<h2>Fitting a multi-level model: improving the model</h2>
<p>For a model with categorical factors, the default R behaviour where the baseline category is labelled as the intercept can be unhelpful.</p>
</section>
<section id="fitting-a-multi-level-model-improving-the-model-1" class="slide level2">
<h2>Fitting a multi-level model: improving the model</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(thr <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> loc <span class="sc">+</span> loc<span class="sc">:</span>fla <span class="sc">+</span> (<span class="dv">0</span> <span class="sc">+</span> loc <span class="sc">+</span> fla<span class="sc">|</span>observer), <span class="at">data =</span> d)</span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="fu">summary</span>(m3) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: thr ~ 0 + loc + loc:fla + (0 + loc + fla | observer)
   Data: d

REML criterion at convergence: 2238

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.800 -0.403 -0.037  0.226  5.244 

Random effects:
 Groups   Name Variance Std.Dev. Corr                         
 observer locr 0.02136  0.1462                                
          locu 0.00813  0.0902   -0.57                        
          locl 0.02231  0.1494   -0.48 -0.41                  
          locd 0.01021  0.1010   -0.50  0.86 -0.46            
          flai 0.25343  0.5034   -0.41  0.46  0.20  0.13      
          flao 0.45819  0.6769    0.40 -0.58  0.23 -0.34  0.06
 Residual      0.26128  0.5112                                
Number of obs: 1307, groups:  observer, 38

Fixed effects:
          Estimate Std. Error t value
locr        0.2444     0.0534    4.57
locu        0.3997     0.0501    7.98
locl        0.2519     0.0537    4.70
locd        0.3298     0.0506    6.52
locr:flai   0.6041     0.1067    5.66
locu:flai   0.7338     0.1061    6.92
locl:flai   0.4633     0.1061    4.37
locd:flai   0.7141     0.1070    6.67
locr:flao   2.0215     0.1304   15.50
locu:flao   2.2534     0.1304   17.29
locl:flao   1.9467     0.1316   14.79
locd:flao   1.9038     0.1297   14.68

Correlation of Fixed Effects:
          locr   locu   locl   locd   locr:flai locu:flai locl:flai locd:flai
locu      -0.074                                                             
locl      -0.096 -0.055                                                      
locd      -0.071  0.081 -0.067                                               
locr:flai -0.541  0.103  0.070  0.031                                        
locu:flai -0.140 -0.328  0.070  0.031  0.589                                 
locl:flai -0.140  0.103 -0.332  0.031  0.589     0.593                       
locd:flai -0.139  0.103  0.070 -0.392  0.586     0.587     0.587             
locr:flao -0.178 -0.144  0.087 -0.093  0.200     0.036     0.036     0.036   
locu:flao  0.151 -0.495  0.087 -0.093  0.036     0.202     0.036     0.036   
locl:flao  0.150 -0.143 -0.239 -0.092  0.036     0.036     0.200     0.036   
locd:flao  0.152 -0.145  0.087 -0.443  0.036     0.036     0.036     0.201   
          locr:flao locu:flao locl:flao
locu                                   
locl                                   
locd                                   
locr:flai                              
locu:flai                              
locl:flai                              
locd:flai                              
locr:flao                              
locu:flao  0.711                       
locl:flao  0.705     0.703             
locd:flao  0.714     0.715     0.705   
optimizer (nloptwrap) convergence code: 0 (OK)
Model failed to converge with max|grad| = 0.0115121 (tol = 0.002, component 1)</code></pre>
</div>
</div>
</section>
<section id="fitting-a-multi-level-model-improving-the-model-2" class="slide level2">
<h2>Fitting a multi-level model: improving the model</h2>
<p>Is a Gaussian distribution a good model for thresholds? Thresholds can’t be negative!</p>
<p>We could use a <strong>log-normal</strong> distribution instead.</p>
<p>Note this means we will need to switch to a new package for multi-level modelling: <code>glmmTMB</code> (as <code>lme4</code> doesn’t have this distribution built in).</p>
</section>
<section id="fitting-a-multi-level-model-improving-the-model-3" class="slide level2">
<h2>Fitting a multi-level model: improving the model</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">library</span>(glmmTMB)  </span>
<span id="cb40-2"><a href="#cb40-2"></a>  </span>
<span id="cb40-3"><a href="#cb40-3"></a>m4 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(thr <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> loc <span class="sc">+</span> loc<span class="sc">:</span>fla <span class="sc">+</span> (<span class="dv">0</span> <span class="sc">+</span> loc <span class="sc">+</span> fla<span class="sc">|</span>observer), </span>
<span id="cb40-4"><a href="#cb40-4"></a>  <span class="at">family =</span> lognormal, <span class="at">data =</span> d) </span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="fu">summary</span>(m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: lognormal  ( log )
Formula:          thr ~ 0 + loc + loc:fla + (0 + loc + fla | observer)
Data: d

     AIC      BIC   logLik deviance df.resid 
      NA       NA       NA       NA     1273 

Random effects:

Conditional model:
 Groups   Name Variance Std.Dev. Corr                          
 observer locr 0.04961  0.2227                                 
          locu 0.00748  0.0865   -0.44                         
          locl 0.04573  0.2138   -0.47 -0.47                   
          locd 0.01180  0.1086   -0.64  0.33 -0.09             
          flai 0.08594  0.2932   -0.11  0.24 -0.06  0.02       
          flao 0.11285  0.3359    0.47 -0.86  0.19 -0.07  0.00 
Number of obs: 1307, groups:  observer, 38

Dispersion parameter for lognormal family (): 0.51 

Conditional model:
          Estimate Std. Error z value Pr(&gt;|z|)    
locr       -0.8137     0.0627  -12.98  &lt; 2e-16 ***
locu       -0.4595     0.0445  -10.33  &lt; 2e-16 ***
locl       -0.7836     0.0607  -12.91  &lt; 2e-16 ***
locd       -0.5771     0.0477  -12.11  &lt; 2e-16 ***
locr:flai   0.4603     0.0790    5.83  5.6e-09 ***
locu:flai   0.5669     0.0701    8.08  6.3e-16 ***
locl:flai   0.4298     0.0780    5.51  3.5e-08 ***
locd:flai   0.6425     0.0726    8.85  &lt; 2e-16 ***
locr:flao   1.4202     0.0780   18.20  &lt; 2e-16 ***
locu:flao   1.3995     0.0719   19.47  &lt; 2e-16 ***
locl:flao   1.3718     0.0779   17.61  &lt; 2e-16 ***
locd:flao   1.2915     0.0737   17.53  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="model-fit-problems" class="slide level2">
<h2>Model fit problems</h2>
<p>Very common to get singular fits, models failing to converge etc.</p>
<p>There can be problems with the <strong>model specification</strong>:</p>
<ul>
<li class="fragment">Overly complex with many interacting variables</li>
<li class="fragment">Collinear predictors that measure related concepts</li>
<li class="fragment">Including between-subjects variables in the random effect structure</li>
</ul>
</section>
<section id="model-fit-problems-1" class="slide level2">
<h2>Model fit problems</h2>
<p>Can also be problems with the <strong>data</strong>:</p>
<ul>
<li class="fragment">Not enough data to fit a complex model</li>
<li class="fragment">Variables on different scales</li>
<li class="fragment">Very noisy, some weird responses</li>
<li class="fragment">Floor/ceiling effects</li>
</ul>
</section>
<section id="model-fit-problems-2" class="slide level2">
<h2>Model fit problems</h2>
<ul>
<li class="fragment">Simplify your model as a last resort!</li>
<li class="fragment">Ideally, simulate your data before conducting your experiment to test if your question is feasible</li>
<li class="fragment">Bayesian models can help avoid some of the pitfalls of LMMs (but have their own challenges!)</li>
</ul>
</section>
<section id="model-inference" class="slide level2">
<h2>Model inference</h2>
<p>You may have noticed <code>lme4</code> doesn’t automatically give <em>p</em>-values.</p>
<p>This is because it’s not immediately clear how to count the degrees of freedom. There is no one correct, agreed up on way of doing this!</p>
<ul>
<li class="fragment">Do we count every unique, individual data point?</li>
<li class="fragment">Maybe it would be better to count the number of participants?</li>
<li class="fragment">Maybe we should count the number of random effects</li>
<li class="fragment">Or some combination??</li>
</ul>
</section>
<section id="model-inference-1" class="slide level2">
<h2>Model inference</h2>
<ul>
<li class="fragment">Satterthwaite approximation via <code>lmerTest</code></li>
<li class="fragment">Model comparison via likelihood ratio test</li>
<li class="fragment"><code>glmmTMB</code> gives Wald p values (but these can be quite anti-conservative!)</li>
</ul>
<div class="fragment">
<p>Always think: do you need <em>p</em>-values? What are you trying to say with them?</p>
</div>
</section>
<section id="making-model-predictions" class="slide level2">
<h2>Making model predictions</h2>
<p>These are <strong>population-level</strong> predictions.</p>
<div class="fragment">
<p>Deterministic - always the same for any given combination of predictors.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>d<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="fu">predict</span>(m4, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  observer des   fla   loc     thr     p
     &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;
1        1 b     n     r     0.252 0.372
2        2 b     n     r     0.250 0.353
3        3 b     n     r     0.199 0.415
4        4 b     n     r     0.222 0.546
5        5 b     n     r     0.230 0.260
6        6 b     n     r     0.219 0.537</code></pre>
</div>
</div>
</div>
</section>
<section id="making-model-predictions-1" class="slide level2">
<h2>Making model predictions</h2>
<p>We can make predictions for ‘new participants’…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb44-2"><a href="#cb44-2"></a>  <span class="at">observer =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">100</span>),</span>
<span id="cb44-3"><a href="#cb44-3"></a>  <span class="at">des =</span> <span class="fu">c</span>(<span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>),</span>
<span id="cb44-4"><a href="#cb44-4"></a>  <span class="at">fla =</span> <span class="fu">c</span>(<span class="st">"n"</span>, <span class="st">"i"</span>, <span class="st">"o"</span>),</span>
<span id="cb44-5"><a href="#cb44-5"></a>  <span class="at">loc =</span> <span class="fu">c</span>(<span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>)</span>
<span id="cb44-6"><a href="#cb44-6"></a>)</span>
<span id="cb44-7"><a href="#cb44-7"></a>  </span>
<span id="cb44-8"><a href="#cb44-8"></a><span class="fu">predict</span>(m4, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"response"</span>, <span class="at">allow.new.levels =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.443 0.702 1.834</code></pre>
</div>
</div>
</section>
<section id="making-model-predictions-2" class="slide level2">
<h2>Making model predictions</h2>
<p>… but they will always be the same (random effects are set to zero!)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb46-2"><a href="#cb46-2"></a>  <span class="at">observer =</span> <span class="fu">c</span>(<span class="dv">101</span>, <span class="dv">101</span>, <span class="dv">101</span>),</span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="at">des =</span> <span class="fu">c</span>(<span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>),</span>
<span id="cb46-4"><a href="#cb46-4"></a>  <span class="at">fla =</span> <span class="fu">c</span>(<span class="st">"n"</span>, <span class="st">"i"</span>, <span class="st">"o"</span>),</span>
<span id="cb46-5"><a href="#cb46-5"></a>  <span class="at">loc =</span> <span class="fu">c</span>(<span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>)</span>
<span id="cb46-6"><a href="#cb46-6"></a>)</span>
<span id="cb46-7"><a href="#cb46-7"></a>  </span>
<span id="cb46-8"><a href="#cb46-8"></a><span class="fu">predict</span>(m4, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"response"</span>, <span class="at">allow.new.levels =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.443 0.702 1.834</code></pre>
</div>
</div>
</section>
<section id="making-model-simulations" class="slide level2">
<h2>Making model simulations</h2>
<p>I.e. predictions that take the <strong>random effects</strong> into account.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>simulations <span class="ot">&lt;-</span> <span class="fu">simulate</span>(m4, <span class="at">nsim =</span> <span class="dv">100</span>, <span class="at">re.form=</span><span class="cn">NULL</span>, <span class="at">allow.new.levels =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb48-2"><a href="#cb48-2"></a>  </span>
<span id="cb48-3"><a href="#cb48-3"></a>simulations <span class="ot">&lt;-</span> simulations <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4"></a>  <span class="fu">pivot_longer</span>(sim_1<span class="sc">:</span>sim_100, <span class="at">names_to =</span> <span class="st">"sim"</span>, <span class="at">values_to =</span> <span class="st">"s"</span>)</span>
<span id="cb48-5"><a href="#cb48-5"></a>  </span>
<span id="cb48-6"><a href="#cb48-6"></a>d_sim <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(), <span class="at">each =</span> <span class="dv">100</span>))</span>
<span id="cb48-7"><a href="#cb48-7"></a></span>
<span id="cb48-8"><a href="#cb48-8"></a>d_sim<span class="sc">$</span>s <span class="ot">&lt;-</span> simulations<span class="sc">$</span>s</span>
<span id="cb48-9"><a href="#cb48-9"></a>d_sim<span class="sc">$</span>group <span class="ot">&lt;-</span> simulations<span class="sc">$</span>sim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="using-model-simulations-for-inference" class="slide level2">
<h2>Using model simulations for inference</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>d_predict <span class="ot">&lt;-</span> d_sim <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>  <span class="fu">select</span>(<span class="sc">-</span>thr, <span class="sc">-</span> p) <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fla, <span class="at">values_from =</span> s) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4"></a>  <span class="fu">mutate</span>(<span class="at">prob_nlowest =</span> n <span class="sc">&lt;</span> <span class="fu">mean</span>(i<span class="sc">+</span>o, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb49-5"><a href="#cb49-5"></a>  <span class="at">prob_ilessthano =</span> i <span class="sc">&lt;</span> o, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb49-6"><a href="#cb49-6"></a></span>
<span id="cb49-7"><a href="#cb49-7"></a><span class="co"># What percentage have no flankers as the lowest threshold?</span></span>
<span id="cb49-8"><a href="#cb49-8"></a><span class="fu">mean</span>(d_predict<span class="sc">$</span>prob_nlowest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.995</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># What percentage have inner flankers as a lower threshold than outer flankers?</span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="fu">mean</span>(d_predict<span class="sc">$</span>prob_ilessthano, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.889</code></pre>
</div>
</div>
</section>
<section id="plotting-your-model-fit" class="slide level2">
<h2>Plotting your model fit</h2>
<p>First we write a little function to create better variable names for plotting.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>short_to_long_names <span class="ot">&lt;-</span> <span class="cf">function</span>(d) {</span>
<span id="cb53-2"><a href="#cb53-2"></a>  d <span class="sc">%&gt;%</span> <span class="fu">rename</span>(</span>
<span id="cb53-3"><a href="#cb53-3"></a>    <span class="at">flanker =</span> <span class="st">"fla"</span>,</span>
<span id="cb53-4"><a href="#cb53-4"></a>    <span class="at">location =</span> <span class="st">"loc"</span>,</span>
<span id="cb53-5"><a href="#cb53-5"></a>    <span class="at">design =</span> <span class="st">"des"</span>,</span>
<span id="cb53-6"><a href="#cb53-6"></a>    <span class="at">threshold =</span> <span class="st">"thr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-7"><a href="#cb53-7"></a>    <span class="fu">mutate</span>(</span>
<span id="cb53-8"><a href="#cb53-8"></a>      <span class="at">flanker =</span> <span class="fu">fct_recode</span>(flanker, <span class="at">none =</span> <span class="st">"n"</span>, <span class="at">inwards =</span> <span class="st">"i"</span>, <span class="at">outwards =</span> <span class="st">"o"</span>),</span>
<span id="cb53-9"><a href="#cb53-9"></a>      <span class="at">location =</span> <span class="fu">fct_recode</span>(location, <span class="at">up =</span> <span class="st">"u"</span>, <span class="at">left =</span> <span class="st">"l"</span>, <span class="at">right =</span> <span class="st">"r"</span>, <span class="at">down =</span> <span class="st">"d"</span>),</span>
<span id="cb53-10"><a href="#cb53-10"></a>      <span class="at">design =</span> <span class="fu">fct_recode</span>(design, <span class="at">precued =</span> <span class="st">"p"</span>, <span class="at">randomised =</span> <span class="st">"r"</span>, <span class="at">blocked =</span> <span class="st">"b"</span>)) <span class="ot">-&gt;</span> d</span>
<span id="cb53-11"><a href="#cb53-11"></a>    </span>
<span id="cb53-12"><a href="#cb53-12"></a>  <span class="fu">return</span>(d)</span>
<span id="cb53-13"><a href="#cb53-13"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-your-model-fit-1" class="slide level2">
<h2>Plotting your model fit</h2>
<p>We use our function to do some setting up.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>d_plt <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>  <span class="fu">short_to_long_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-4"><a href="#cb54-4"></a>    <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y=</span> <span class="dv">0</span>,</span>
<span id="cb54-5"><a href="#cb54-5"></a>    <span class="at">x =</span> <span class="fu">if_else</span>(location <span class="sc">==</span> <span class="st">"right"</span>, threshold, x),</span>
<span id="cb54-6"><a href="#cb54-6"></a>    <span class="at">x =</span> <span class="fu">if_else</span>(location <span class="sc">==</span> <span class="st">"left"</span>, <span class="sc">-</span>threshold,x ),</span>
<span id="cb54-7"><a href="#cb54-7"></a>    <span class="at">y =</span> <span class="fu">if_else</span>(location <span class="sc">==</span> <span class="st">"up"</span>,  threshold, y),</span>
<span id="cb54-8"><a href="#cb54-8"></a>    <span class="at">y =</span> <span class="fu">if_else</span>(location <span class="sc">==</span> <span class="st">"down"</span>,  <span class="sc">-</span>threshold, y)</span>
<span id="cb54-9"><a href="#cb54-9"></a>  )</span>
<span id="cb54-10"><a href="#cb54-10"></a>  </span>
<span id="cb54-11"><a href="#cb54-11"></a>d_plot <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb54-12"><a href="#cb54-12"></a>  <span class="fu">mutate</span>(<span class="at">thr =</span><span class="fu">predict</span>(m4, <span class="at">type =</span> <span class="st">"response"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-13"><a href="#cb54-13"></a>  <span class="fu">short_to_long_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-14"><a href="#cb54-14"></a>   <span class="fu">mutate</span>(</span>
<span id="cb54-15"><a href="#cb54-15"></a>    <span class="at">threshold =</span> <span class="fu">if_else</span>(location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"down"</span>, <span class="st">"left"</span>), <span class="sc">-</span>threshold, threshold))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-your-model-fit-2" class="slide level2">
<h2>Plotting your model fit</h2>
<p>We’ll begin by plotting the up and down data.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-2"><a href="#cb55-2"></a>    <span class="fu">geom_jitter</span>(<span class="at">data =</span> <span class="fu">filter</span>(d_plt, </span>
<span id="cb55-3"><a href="#cb55-3"></a>                              location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"up"</span>, <span class="st">"down"</span>),</span>
<span id="cb55-4"><a href="#cb55-4"></a>                              flanker <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"inwards"</span>, <span class="st">"outwards"</span>)) , </span>
<span id="cb55-5"><a href="#cb55-5"></a>                <span class="fu">aes</span>(x, y, <span class="at">group =</span> flanker), </span>
<span id="cb55-6"><a href="#cb55-6"></a>                <span class="at">width =</span> .<span class="dv">2</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">"darkred"</span>, <span class="at">shape =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-your-model-fit-3" class="slide level2">
<h2>Plotting your model fit</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-49-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="plotting-your-model-fit-4" class="slide level2">
<h2>Plotting your model fit</h2>
<p>We can then add the left and right data.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb57-2"><a href="#cb57-2"></a>    <span class="fu">geom_jitter</span>(<span class="at">data =</span> <span class="fu">filter</span>(d_plt, </span>
<span id="cb57-3"><a href="#cb57-3"></a>                              location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"up"</span>, <span class="st">"down"</span>),</span>
<span id="cb57-4"><a href="#cb57-4"></a>                              flanker <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"inwards"</span>, <span class="st">"outwards"</span>)) , </span>
<span id="cb57-5"><a href="#cb57-5"></a>                <span class="fu">aes</span>(x, y, <span class="at">group =</span> flanker), </span>
<span id="cb57-6"><a href="#cb57-6"></a>                <span class="at">width =</span> .<span class="dv">2</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">"darkred"</span>, <span class="at">shape =</span> <span class="dv">4</span>)  <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7"></a>    <span class="fu">geom_jitter</span>(<span class="at">data =</span> <span class="fu">filter</span>(d_plt,</span>
<span id="cb57-8"><a href="#cb57-8"></a>                              location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"right"</span>),</span>
<span id="cb57-9"><a href="#cb57-9"></a>                              flanker <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"inwards"</span>, <span class="st">"outwards"</span>)) , </span>
<span id="cb57-10"><a href="#cb57-10"></a>            <span class="fu">aes</span>(x, y, <span class="at">group =</span> flanker), </span>
<span id="cb57-11"><a href="#cb57-11"></a>            <span class="at">width =</span> <span class="dv">0</span>, <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">"darkred"</span>, <span class="at">shape =</span> <span class="dv">4</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-your-model-fit-5" class="slide level2">
<h2>Plotting your model fit</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-51-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="plotting-your-model-fit-6" class="slide level2">
<h2>Plotting your model fit</h2>
<p>We will add the model predictions (as a violin plot).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb59-2"><a href="#cb59-2"></a>    <span class="fu">geom_jitter</span>(<span class="at">data =</span> <span class="fu">filter</span>(d_plt, </span>
<span id="cb59-3"><a href="#cb59-3"></a>                              location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"up"</span>, <span class="st">"down"</span>),</span>
<span id="cb59-4"><a href="#cb59-4"></a>                              flanker <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"inwards"</span>, <span class="st">"outwards"</span>)) , </span>
<span id="cb59-5"><a href="#cb59-5"></a>                <span class="fu">aes</span>(x, y, <span class="at">group =</span> flanker), </span>
<span id="cb59-6"><a href="#cb59-6"></a>                <span class="at">width =</span> .<span class="dv">2</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">"darkred"</span>, <span class="at">shape =</span> <span class="dv">4</span>)  <span class="sc">+</span></span>
<span id="cb59-7"><a href="#cb59-7"></a>    <span class="fu">geom_jitter</span>(<span class="at">data =</span> <span class="fu">filter</span>(d_plt,</span>
<span id="cb59-8"><a href="#cb59-8"></a>                              location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"right"</span>),</span>
<span id="cb59-9"><a href="#cb59-9"></a>                              flanker <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"inwards"</span>, <span class="st">"outwards"</span>)) , </span>
<span id="cb59-10"><a href="#cb59-10"></a>            <span class="fu">aes</span>(x, y, <span class="at">group =</span> flanker), </span>
<span id="cb59-11"><a href="#cb59-11"></a>            <span class="at">width =</span> <span class="dv">0</span>, <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">"darkred"</span>, <span class="at">shape =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb59-12"><a href="#cb59-12"></a>    <span class="fu">geom_violin</span>(<span class="at">data =</span> <span class="fu">filter</span>(d_plot, </span>
<span id="cb59-13"><a href="#cb59-13"></a>                              location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"up"</span>, <span class="st">"down"</span>),</span>
<span id="cb59-14"><a href="#cb59-14"></a>                              flanker <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"inwards"</span>, <span class="st">"outwards"</span>)), </span>
<span id="cb59-15"><a href="#cb59-15"></a>                <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> threshold, <span class="at">group =</span> location),</span>
<span id="cb59-16"><a href="#cb59-16"></a>                <span class="at">width =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>, <span class="at">trim =</span> <span class="cn">FALSE</span>,</span>
<span id="cb59-17"><a href="#cb59-17"></a>                <span class="at">position =</span>  <span class="fu">position_identity</span>(),</span>
<span id="cb59-18"><a href="#cb59-18"></a>                <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb59-19"><a href="#cb59-19"></a>    <span class="fu">geom_violin</span>(<span class="at">data =</span> <span class="fu">filter</span>(d_plot, </span>
<span id="cb59-20"><a href="#cb59-20"></a>                              location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"right"</span>),</span>
<span id="cb59-21"><a href="#cb59-21"></a>                              flanker <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"inwards"</span>, <span class="st">"outwards"</span>)), </span>
<span id="cb59-22"><a href="#cb59-22"></a>                <span class="fu">aes</span>(<span class="at">x =</span> threshold, <span class="at">y=</span> <span class="dv">0</span>, <span class="at">group =</span> location),</span>
<span id="cb59-23"><a href="#cb59-23"></a>                <span class="at">width =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>, <span class="at">trim =</span> <span class="cn">FALSE</span>,</span>
<span id="cb59-24"><a href="#cb59-24"></a>                <span class="at">position =</span>  <span class="fu">position_identity</span>(),</span>
<span id="cb59-25"><a href="#cb59-25"></a>                <span class="at">fill =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-your-model-fit-7" class="slide level2">
<h2>Plotting your model fit</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-53-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="plotting-your-model-fit-8" class="slide level2">
<h2>Plotting your model fit</h2>
<p>Finally, we’ll split the plot into different facets for each flanker type.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb61-2"><a href="#cb61-2"></a>    <span class="fu">geom_jitter</span>(<span class="at">data =</span> <span class="fu">filter</span>(d_plt, </span>
<span id="cb61-3"><a href="#cb61-3"></a>                              location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"up"</span>, <span class="st">"down"</span>),</span>
<span id="cb61-4"><a href="#cb61-4"></a>                              flanker <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"inwards"</span>, <span class="st">"outwards"</span>)) , </span>
<span id="cb61-5"><a href="#cb61-5"></a>                <span class="fu">aes</span>(x, y, <span class="at">group =</span> flanker), </span>
<span id="cb61-6"><a href="#cb61-6"></a>                <span class="at">width =</span> .<span class="dv">2</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">"darkred"</span>, <span class="at">shape =</span> <span class="dv">4</span>)  <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7"></a>    <span class="fu">geom_jitter</span>(<span class="at">data =</span> <span class="fu">filter</span>(d_plt,</span>
<span id="cb61-8"><a href="#cb61-8"></a>                              location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"right"</span>),</span>
<span id="cb61-9"><a href="#cb61-9"></a>                              flanker <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"inwards"</span>, <span class="st">"outwards"</span>)) , </span>
<span id="cb61-10"><a href="#cb61-10"></a>            <span class="fu">aes</span>(x, y, <span class="at">group =</span> flanker), </span>
<span id="cb61-11"><a href="#cb61-11"></a>            <span class="at">width =</span> <span class="dv">0</span>, <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">"darkred"</span>, <span class="at">shape =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12"></a>    <span class="fu">geom_violin</span>(<span class="at">data =</span> <span class="fu">filter</span>(d_plot, </span>
<span id="cb61-13"><a href="#cb61-13"></a>                              location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"up"</span>, <span class="st">"down"</span>),</span>
<span id="cb61-14"><a href="#cb61-14"></a>                              flanker <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"inwards"</span>, <span class="st">"outwards"</span>)), </span>
<span id="cb61-15"><a href="#cb61-15"></a>                <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> threshold, <span class="at">group =</span> location),</span>
<span id="cb61-16"><a href="#cb61-16"></a>                <span class="at">width =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>, <span class="at">trim =</span> <span class="cn">FALSE</span>,</span>
<span id="cb61-17"><a href="#cb61-17"></a>                <span class="at">position =</span>  <span class="fu">position_identity</span>(),</span>
<span id="cb61-18"><a href="#cb61-18"></a>                <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb61-19"><a href="#cb61-19"></a>    <span class="fu">geom_violin</span>(<span class="at">data =</span> <span class="fu">filter</span>(d_plot, </span>
<span id="cb61-20"><a href="#cb61-20"></a>                              location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"right"</span>),</span>
<span id="cb61-21"><a href="#cb61-21"></a>                              flanker <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"inwards"</span>, <span class="st">"outwards"</span>)), </span>
<span id="cb61-22"><a href="#cb61-22"></a>                <span class="fu">aes</span>(<span class="at">x =</span> threshold, <span class="at">y=</span> <span class="dv">0</span>, <span class="at">group =</span> location),</span>
<span id="cb61-23"><a href="#cb61-23"></a>                <span class="at">width =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.33</span>, <span class="at">trim =</span> <span class="cn">FALSE</span>,</span>
<span id="cb61-24"><a href="#cb61-24"></a>                <span class="at">position =</span>  <span class="fu">position_identity</span>(),</span>
<span id="cb61-25"><a href="#cb61-25"></a>                <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb61-26"><a href="#cb61-26"></a>      <span class="fu">coord_fixed</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb61-27"><a href="#cb61-27"></a>    <span class="fu">scale_x_continuous</span>(<span class="st">"Threshold (degrees)"</span>) <span class="sc">+</span> </span>
<span id="cb61-28"><a href="#cb61-28"></a>    <span class="fu">scale_y_continuous</span>(<span class="st">"Threshold (degrees)"</span>) <span class="sc">+</span></span>
<span id="cb61-29"><a href="#cb61-29"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span> flanker)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-your-model-fit-9" class="slide level2">
<h2>Plotting your model fit</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-55-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="summary-1" class="slide level2">
<h2>Summary</h2>
<ul>
<li class="fragment">Random effects structures can include both slopes and intercepts</li>
<li class="fragment">Model fit problems are (unfortunately) common - think carefully about your data collection and model structure</li>
<li class="fragment">Many approaches to inference - what question are you trying to ask?</li>
<li class="fragment">Build up publication-ready plots slowly!</li>
</ul>
</section></section>
<section>
<section id="psychophysics" class="title-slide slide level1 center">
<h1>Psychophysics</h1>

</section>
<section id="psychophysics-as-multi-level-models" class="slide level2">
<h2>Psychophysics as multi-level models</h2>
<ul>
<li class="fragment">In the previous example, our data consisted of pre-computed thresholds</li>
<li class="fragment">However, we can use multi-level models to compute our psychometric thresholds</li>
<li class="fragment"><a href="https://jov.arvojournals.org/article.aspx?articleid=2192152">Modelling psychophysical data at the population level</a></li>
</ul>
</section>
<section id="simulating-data" class="slide level2">
<h2>Simulating data</h2>
<p>We are using simulated data from the <code>MixedPsy</code> package for simplicity here.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="fu">library</span>(MixedPsy)</span>
<span id="cb63-2"><a href="#cb63-2"></a>  </span>
<span id="cb63-3"><a href="#cb63-3"></a>d <span class="ot">&lt;-</span> simul_data</span>
<span id="cb63-4"><a href="#cb63-4"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X Intercept  Slope Longer Total Subject
1 40     -7.87 0.0882      0    40      S1
2 50     -7.87 0.0882      0    40      S1
3 60     -7.87 0.0882      0    40      S1
4 70     -7.87 0.0882      2    40      S1
5 80     -7.87 0.0882     10    40      S1
6 90     -7.87 0.0882     24    40      S1</code></pre>
</div>
</div>
</section>
<section id="fitting-a-model" class="slide level2">
<h2>Fitting a model</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># using lme4  </span></span>
<span id="cb65-2"><a href="#cb65-2"></a>m <span class="ot">&lt;-</span> <span class="fu">glmer</span>(<span class="fu">cbind</span>(Longer, Total <span class="sc">-</span> Longer) <span class="sc">~</span> X <span class="sc">+</span> (X<span class="sc">|</span>Subject), </span>
<span id="cb65-3"><a href="#cb65-3"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>), <span class="at">data =</span> d)</span>
<span id="cb65-4"><a href="#cb65-4"></a></span>
<span id="cb65-5"><a href="#cb65-5"></a><span class="co"># using glmmTMB</span></span>
<span id="cb65-6"><a href="#cb65-6"></a>m2 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(<span class="fu">cbind</span>(Longer, Total <span class="sc">-</span> Longer) <span class="sc">~</span> X <span class="sc">+</span> (X<span class="sc">|</span>Subject), </span>
<span id="cb65-7"><a href="#cb65-7"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>), <span class="at">data =</span> d)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-summary" class="slide level2">
<h2>Model summary</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( probit )
Formula: cbind(Longer, Total - Longer) ~ X + (X | Subject)
   Data: d

     AIC      BIC   logLik deviance df.resid 
     219      230     -104      209       67 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.944 -0.212  0.033  0.416  3.323 

Random effects:
 Groups  Name        Variance Std.Dev. Corr
 Subject (Intercept) 1.39e+00 1.179741     
         X           2.86e-07 0.000535 1.00
Number of obs: 72, groups:  Subject, 8

Fixed effects:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -6.85714    0.49033   -14.0   &lt;2e-16 ***
X            0.09106    0.00338    26.9   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
  (Intr)
X -0.462
optimizer (Nelder_Mead) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
</section>
<section id="setting-up-data-for-prediction" class="slide level2">
<h2>Setting up data for prediction</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>d_sim <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb68-2"><a href="#cb68-2"></a>  <span class="at">X =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">40</span>, <span class="at">to =</span> <span class="dv">120</span>, <span class="at">by =</span> <span class="dv">10</span>),  <span class="at">times =</span> <span class="dv">8</span>),</span>
<span id="cb68-3"><a href="#cb68-3"></a>  <span class="at">Subject =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>, <span class="st">"S4"</span>, <span class="st">"S5"</span>, <span class="st">"S6"</span>, <span class="st">"S7"</span>, <span class="st">"S8"</span>), <span class="at">each =</span> <span class="dv">9</span>)</span>
<span id="cb68-4"><a href="#cb68-4"></a>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="making-predictions" class="slide level2">
<h2>Making predictions</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>d_sim<span class="sc">$</span>prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">type =</span> <span class="st">"response"</span>, <span class="at">newdata =</span> d_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-data-and-model-predictions" class="slide level2">
<h2>Plotting data and model predictions</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Longer<span class="sc">/</span>Total)) <span class="sc">+</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>  <span class="fu">ylab</span>(<span class="st">"Probability"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span></span>
<span id="cb70-3"><a href="#cb70-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb70-4"><a href="#cb70-4"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> d_sim, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> prediction)) <span class="sc">+</span></span>
<span id="cb70-5"><a href="#cb70-5"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Subject, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb70-6"><a href="#cb70-6"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> <span class="fu">seq</span>(<span class="dv">40</span>, <span class="dv">120</span>, <span class="at">by =</span> <span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ecvp2024_files/figure-revealjs/unnamed-chunk-61-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="pses" class="slide level2">
<h2>PSEs</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="sc">-</span><span class="fu">fixef</span>(m)[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">fixef</span>(m)[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
       75.3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co"># or there are automatic ways to do these things</span></span>
<span id="cb73-2"><a href="#cb73-2"></a>bootstrap_estimate <span class="ot">&lt;-</span> <span class="fu">pseMer</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>================================================================================
[1] "JND   95 % CI: 6.80722903497503    8.00491563431959"
[1] "PSE   95 % CI: 64.7973482650194    83.9265612210936"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>bootstrap_estimate<span class="sc">$</span>summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate Inferior Superior
JND     7.41     6.81      8.0
PSE    75.30    64.80     83.9</code></pre>
</div>
</div>
</section>
<section id="pses-by-participant" class="slide level2">
<h2>PSEs by participant</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>ppt <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb77-2"><a href="#cb77-2"></a></span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="sc">-</span>(<span class="fu">fixef</span>(m)[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">ranef</span>(m)<span class="sc">$</span>Subject[ppt,<span class="dv">1</span>])<span class="sc">/</span>(<span class="fu">fixef</span>(m)[<span class="dv">2</span>]<span class="sc">+</span><span class="fu">ranef</span>(m)<span class="sc">$</span>Subject[ppt,<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
       88.8 </code></pre>
</div>
</div>
</section>
<section id="pses-by-participant-bootstrapped" class="slide level2">
<h2>PSEs by participant, bootstrapped</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>fun2mod <span class="ot">=</span> <span class="cf">function</span>(mer.obj){</span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="co">#allocate space: we'll just work out subj 1 and 2 for now</span></span>
<span id="cb79-3"><a href="#cb79-3"></a>jndpse <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"numeric"</span>, <span class="at">length =</span> <span class="dv">2</span>)</span>
<span id="cb79-4"><a href="#cb79-4"></a><span class="fu">names</span>(jndpse) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"ppt1"</span>, <span class="st">"ppt2"</span>)</span>
<span id="cb79-5"><a href="#cb79-5"></a>jndpse[<span class="dv">1</span>] <span class="ot">=</span> <span class="sc">-</span>(<span class="fu">fixef</span>(mer.obj)[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">ranef</span>(mer.obj)<span class="sc">$</span>Subject[<span class="dv">1</span>,<span class="dv">1</span>])<span class="sc">/</span>(<span class="fu">fixef</span>(mer.obj)[<span class="dv">2</span>]<span class="sc">+</span><span class="fu">ranef</span>(mer.obj)<span class="sc">$</span>Subject[<span class="dv">1</span>,<span class="dv">2</span>]) <span class="co">#ppt1</span></span>
<span id="cb79-6"><a href="#cb79-6"></a>jndpse[<span class="dv">2</span>] <span class="ot">=</span> <span class="sc">-</span>(<span class="fu">fixef</span>(mer.obj)[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">ranef</span>(mer.obj)<span class="sc">$</span>Subject[<span class="dv">2</span>,<span class="dv">1</span>])<span class="sc">/</span>(<span class="fu">fixef</span>(mer.obj)[<span class="dv">2</span>]<span class="sc">+</span><span class="fu">ranef</span>(mer.obj)<span class="sc">$</span>Subject[<span class="dv">2</span>,<span class="dv">2</span>]) <span class="co">#ppt2</span></span>
<span id="cb79-7"><a href="#cb79-7"></a><span class="fu">return</span>(jndpse)</span>
<span id="cb79-8"><a href="#cb79-8"></a>}</span>
<span id="cb79-9"><a href="#cb79-9"></a>  </span>
<span id="cb79-10"><a href="#cb79-10"></a>ppt_bootstrap_estimate <span class="ot">&lt;-</span> <span class="fu">pseMer</span>(m, <span class="at">B =</span> <span class="dv">100</span>, <span class="at">FUN =</span> fun2mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>================================================================================
[1] "ppt1   95 % CI: 47.2726866555667    107.363126527741"
[1] "ppt2   95 % CI: 48.7738987746106    102.704689098633"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>ppt_bootstrap_estimate<span class="sc">$</span>summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Estimate Inferior Superior
ppt1     87.4     47.3      107
ppt2     53.4     48.8      103</code></pre>
</div>
</div>
</section>
<section id="summary-2" class="slide level2">
<h2>Summary</h2>
<ul>
<li class="fragment">Mixed models have benefits for calculating psychophysical curves - can take into account information about trial repetitions, subject-specific variability, can easily assess goodness of fit</li>
<li class="fragment">Lots of helpful tutorials available <a href="https://mixedpsychophysics.wordpress.com/">here</a></li>
</ul>
</section>
<section id="final-summary" class="slide level2">
<h2>Final summary</h2>
<ul>
<li class="fragment">We (hopefully) now have time to do more workbook exercises</li>
<li class="fragment">Do ask us any questions you have! (If not now, find us during the conference)</li>
</ul>
<div class="footer footer-default">
<p>Clarke &amp; Hughes 2024</p>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="ecvp2024_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="ecvp2024_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="ecvp2024_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="ecvp2024_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="ecvp2024_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="ecvp2024_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="ecvp2024_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="ecvp2024_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="ecvp2024_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="ecvp2024_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="ecvp2024_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>